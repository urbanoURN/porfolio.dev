---
const { title, description, image, tags, index, link, github } = Astro.props;
const MAX_LEN = 180;
const isLong = description.length > MAX_LEN;
const short = description.substring(0, MAX_LEN).trim();
const rest = isLong ? description.substring(MAX_LEN).trim() : "";
---

<script is:client="load">
  function toggleDescription(id) {
    const dots = document.getElementById(`dots-${id}`);
    const more = document.getElementById(`more-${id}`);
    const btn = document.getElementById(`btn-${id}`);

    const isHidden = dots.style.display !== "none";

    dots.style.display = isHidden ? "none" : "inline";
    more.style.display = isHidden ? "inline" : "none";
    btn.innerText = isHidden ? "Mostrar menos" : "Saber más";
  }
</script>




<article class="flex flex-col md:flex-row items-center bg-[#050505] border border-white/10 rounded-xl shadow-xl shadow-white/10 hover:shadow-2xl transition-all duration-300 p-4 gap-6 mb-10">
  <img
    class="rounded-lg w-full md:w-1/2 h-auto object-cover"
    src={image}
    alt={`Imagen del proyecto ${title}`}
  />

  <div class="flex flex-col justify-between w-full md:w-1/2 text-white">
    <h3 class="text-xl md:text-1xl font-bold text-yellow-200 mb-2">{title}</h3>

    <p class="mb-4 text-sm md:text-base text-gray-300 leading-relaxed">
      {short}
      {isLong && (
        <>
          <span id={`dots-${index}`}>…</span>
          <span id={`more-${index}`} style="display: none;"> {rest}</span>
          <button
            id={`btn-${index}`}
            type="button"
            class="text-blue-400 underline ml-1"
            onClick={`toggleDescription(${index})`}
          >
            Saber más
          </button>
        </>
      )}
    </p>

    <ul class="flex flex-wrap gap-2 mb-4">
      {tags.map((tag) => (
        <li>
          <span class={`flex items-center gap-1 rounded-full text-xs font-medium ${tag.class} px-3 py-1`}>
            <tag.icon class="size-4" />
            {tag.name}
          </span>
        </li>
      ))}
    </ul>

    <div class="flex gap-4">
      {github && (
        <a href={github} target="_blank" class="bg-white text-black text-sm font-semibold px-4 py-2 rounded-lg shadow-md hover:bg-gray-200 transition">
          Code
        </a>
      )}
      {link && (
        <a href={link} target="_blank" class="bg-transparent border border-white text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-white hover:text-black transition">
          Preview
        </a>
      )}
    </div>
  </div>
</article>
 